.. _java_challenge_response_example:    

Java Challenge Response Example
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

Initialize Challenge Response module

.. code-block:: java

    import org.sertiscorp.oneml.face.*;
    ChallengeResponse challenge = new ChallengeResponse();

Initialize Challenge Response module from existing FaceDetector and FaceLandmarkDetector

.. code-block:: java

    import org.sertiscorp.oneml.face.*;
    FaceDetector face_detector = new FaceDetector();
    FaceLandmarkDetector face_landmark = new FaceLandmarkDetector();
    ChallengeResponse challenge = new ChallengeResponse(face_detector, face_landmark);

Initialize Challenge Response module with licensing

.. code-block:: java

    import org.sertiscorp.oneml.face.*;
    LicenseManager license_manager = new LicenseManager();
    license_manager.set_key("LICENSE_KEY_VALUE_HERE");
    license_manager.activate_key();
    ChallengeResponse challenge = new ChallengeResponse(license_manager);

Initialize Challenge Response module with licensing from existing FaceDetector and FaceLandmarkDetector

.. code-block:: java

    import org.sertiscorp.oneml.face.*;
    LicenseManager license_manager = new LicenseManager();
    license_manager.set_key("LICENSE_KEY_VALUE_HERE");
    license_manager.activate_key();

    FaceDetector face_detector = new FaceDetector(license_manager);
    FaceLandmarkDetector face_landmark = new FaceLandmarkDetector(license_manager);
    ChallengeResponse challenge = new ChallengeResponse(face_detector, face_landmark, license_manager);

Run the module from videos

.. code-block:: java

    String vidPath = "path/to/video.mp4";
    ChallengeResponseResult result = challenge.run(vidPath);

Run the module from stream of images (can be used with opencv VideoCapture)

.. code-block:: java

    # if we can still read frame from image stream
    while (can_read_frame):
        # use any function to get each frame from image stream
        Image frame = getOneFrame()
        ChallengeResponseResult result = challenge.run(frame)
    challenge.reset()

Run the module with ImageBatch

.. code-block:: java
    
    // create ImageBatch
    Utils utils = new Utils();

    String vidPath = "path/to/video.mp4";
    ImageBatch images = utils.videoToImages(vidPath);

    // run ChallengeResponse with ImageBatch
    ChallengeResponseResult result = challenge.run(images);

Get result

.. code-block:: java

    System.out.println("status: " + result.getReturnStatus());
    System.out.println("is_blink: " + result.isBlink());
    System.out.println("number of blinks: " + result.getNumBlinks());
    System.out.println("liveness_score: " + result.getLivenessScore());
    Image bestFrame = result.getBestFrame();